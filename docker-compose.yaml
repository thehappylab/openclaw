services:
  openclaw:
    image: 'ghcr.io/thehappylab/openclaw:latest'
    environment:
      AUTH_USERNAME: $SERVICE_USER_OPENCLAW
      AUTH_PASSWORD: $SERVICE_PASSWORD_OPENCLAW
      OPENCLAW_GATEWAY_TOKEN: $SERVICE_PASSWORD_64_GATEWAYTOKEN
      ANTHROPIC_API_KEY: '${ANTHROPIC_API_KEY}'
      OPENAI_API_KEY: '${OPENAI_API_KEY}'
      OPENROUTER_API_KEY: '${OPENROUTER_API_KEY}'
      GEMINI_API_KEY: '${GEMINI_API_KEY}'
      XAI_API_KEY: '${XAI_API_KEY}'
      GROQ_API_KEY: '${GROQ_API_KEY}'
      MISTRAL_API_KEY: '${MISTRAL_API_KEY}'
      CEREBRAS_API_KEY: '${CEREBRAS_API_KEY}'
      VENICE_API_KEY: '${VENICE_API_KEY}'
      MOONSHOT_API_KEY: '${MOONSHOT_API_KEY}'
      KIMI_API_KEY: '${KIMI_API_KEY}'
      MINIMAX_API_KEY: '${MINIMAX_API_KEY}'
      ZAI_API_KEY: '${ZAI_API_KEY}'
      AI_GATEWAY_API_KEY: '${AI_GATEWAY_API_KEY}'
      OPENCODE_API_KEY: '${OPENCODE_API_KEY}'
      SYNTHETIC_API_KEY: '${SYNTHETIC_API_KEY}'
      COPILOT_GITHUB_TOKEN: '${COPILOT_GITHUB_TOKEN}'
      XIAOMI_API_KEY: '${XIAOMI_API_KEY}'
      OPENCLAW_PRIMARY_MODEL: '${OPENCLAW_PRIMARY_MODEL}'
      DEEPGRAM_API_KEY: '${DEEPGRAM_API_KEY}'
      AWS_ACCESS_KEY_ID: '${AWS_ACCESS_KEY_ID}'
      AWS_SECRET_ACCESS_KEY: '${AWS_SECRET_ACCESS_KEY}'
      AWS_REGION: '${AWS_REGION:-us-east-1}'
      AWS_SESSION_TOKEN: '${AWS_SESSION_TOKEN}'
      BEDROCK_PROVIDER_FILTER: '${BEDROCK_PROVIDER_FILTER:-anthropic}'
      OLLAMA_BASE_URL: '${OLLAMA_BASE_URL}'
      PORT: '8080'
      OPENCLAW_GATEWAY_PORT: '18789'
      OPENCLAW_GATEWAY_BIND: '${OPENCLAW_GATEWAY_BIND:-loopback}'
      OPENCLAW_STATE_DIR: /data/.openclaw
      OPENCLAW_WORKSPACE_DIR: /data/workspace
      BROWSER_CDP_URL: 'http://browser:9223'
      BROWSER_DEFAULT_PROFILE: '${BROWSER_DEFAULT_PROFILE:-openclaw}'
      BROWSER_EVALUATE_ENABLED: '${BROWSER_EVALUATE_ENABLED:-true}'
      BROWSER_SNAPSHOT_MODE: '${BROWSER_SNAPSHOT_MODE:-efficient}'
      BROWSER_REMOTE_TIMEOUT_MS: '${BROWSER_REMOTE_TIMEOUT_MS:-1500}'
      BROWSER_REMOTE_HANDSHAKE_TIMEOUT_MS: '${BROWSER_REMOTE_HANDSHAKE_TIMEOUT_MS:-3000}'
      HOOKS_ENABLED: '${HOOKS_ENABLED:-false}'
      HOOKS_PATH: '${HOOKS_PATH:-/hooks}'
      MOONSHOT_BASE_URL: '${MOONSHOT_BASE_URL:-https://api.moonshot.ai/v1}'
      KIMI_BASE_URL: '${KIMI_BASE_URL:-https://api.moonshot.ai/anthropic}'
      TELEGRAM_BOT_TOKEN: $TELEGRAM_BOT_TOKEN
      DISCORD_BOT_TOKEN: $DISCORD_BOT_TOKEN
      SLACK_BOT_TOKEN: $SLACK_BOT_TOKEN
      SLACK_APP_TOKEN: $SLACK_APP_TOKEN
      WHATSAPP_ENABLED: $WHATSAPP_ENABLED
      OPENCLAW_DOCKER_APT_PACKAGES: $OPENCLAW_DOCKER_APT_PACKAGES
      COOLIFY_RESOURCE_UUID: vo848kgko44wscs08kg8wwcg
      COOLIFY_CONTAINER_NAME: openclaw-vo848kgko44wscs08kg8wwcg
      COOLIFY_FQDN: openclaw-guru.thehappylab.com
      COOLIFY_URL: 'https://openclaw-guru.thehappylab.com'
      SERVICE_NAME_OPENCLAW: openclaw
      SERVICE_NAME_BROWSER: browser
    volumes:
      - 'vo848kgko44wscs08kg8wwcg_twwsc88wo448cccs004os408-openclaw-data:/data'
    depends_on:
      browser:
        condition: service_healthy
    healthcheck:
      test:
        - CMD
        - curl
        - '-sf'
        - 'http://127.0.0.1:8080/healthz'
      interval: 10s
      timeout: 10s
      retries: 5
    container_name: openclaw-vo848kgko44wscs08kg8wwcg
    restart: unless-stopped
    labels:
      - coolify.managed=true
      - coolify.version=4.0.0-beta.463
      - coolify.serviceId=4
      - coolify.type=service
      - coolify.name=openclaw-twwsc88wo448cccs004os408
      - coolify.resourceName=openclaw
      - coolify.projectName=openclaw
      - coolify.serviceName=openclaw-guru
      - coolify.environmentName=production
      - coolify.pullRequestId=0
      - coolify.service.subId=4
      - coolify.service.subType=application
      - coolify.service.subName=openclaw-guru
      - traefik.enable=true
      - traefik.http.middlewares.gzip.compress=true
      - traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https
      - traefik.http.routers.http-0-twwsc88wo448cccs004os408-openclaw.entryPoints=http
      - traefik.http.routers.http-0-twwsc88wo448cccs004os408-openclaw.middlewares=redirect-to-https
      - 'traefik.http.routers.http-0-twwsc88wo448cccs004os408-openclaw.rule=Host(`openclaw-guru.thehappylab.com`) && PathPrefix(`/`)'
      - traefik.http.routers.http-0-twwsc88wo448cccs004os408-openclaw.service=http-0-twwsc88wo448cccs004os408-openclaw
      - traefik.http.routers.https-0-twwsc88wo448cccs004os408-openclaw.entryPoints=https
      - traefik.http.routers.https-0-twwsc88wo448cccs004os408-openclaw.middlewares=gzip
      - 'traefik.http.routers.https-0-twwsc88wo448cccs004os408-openclaw.rule=Host(`openclaw-guru.thehappylab.com`) && PathPrefix(`/`)'
      - traefik.http.routers.https-0-twwsc88wo448cccs004os408-openclaw.service=https-0-twwsc88wo448cccs004os408-openclaw
      - traefik.http.routers.https-0-twwsc88wo448cccs004os408-openclaw.tls.certresolver=letsencrypt
      - traefik.http.routers.https-0-twwsc88wo448cccs004os408-openclaw.tls=true
      - traefik.http.services.http-0-twwsc88wo448cccs004os408-openclaw.loadbalancer.server.port=8080
      - traefik.http.services.https-0-twwsc88wo448cccs004os408-openclaw.loadbalancer.server.port=8080
      - 'caddy_0.encode=zstd gzip'
      - 'caddy_0.handle_path.0_reverse_proxy={{upstreams 8080}}'
      - 'caddy_0.handle_path=/*'
      - caddy_0.header=-Server
      - 'caddy_0.try_files={path} /index.html /index.php'
      - 'caddy_0=https://openclaw-guru.thehappylab.com'
      - caddy_ingress_network=twwsc88wo448cccs004os408
      - coolify.managed=true
      - coolify.version=4.0.0-beta.463
      - coolify.serviceId=14
      - coolify.type=service
      - coolify.name=openclaw-vo848kgko44wscs08kg8wwcg
      - coolify.resourceName=service-t0w8wkcgk0g4k4kswkk8kks8
      - coolify.projectName=openclaw
      - coolify.serviceName=openclaw
      - coolify.environmentName=production
      - coolify.pullRequestId=0
      - coolify.service.subId=20
      - coolify.service.subType=application
      - coolify.service.subName=openclaw
    networks:
      vo848kgko44wscs08kg8wwcg: null
    env_file:
      - .env
  browser:
    image: 'coollabsio/openclaw-browser:latest'
    environment:
      PUID: '1000'
      PGID: '1000'
      TZ: Etc/UTC
      CHROME_CLI: '--remote-debugging-port=9222'
      COOLIFY_RESOURCE_UUID: vo848kgko44wscs08kg8wwcg
      COOLIFY_CONTAINER_NAME: browser-vo848kgko44wscs08kg8wwcg
      SERVICE_NAME_OPENCLAW: openclaw
      SERVICE_NAME_BROWSER: browser
    volumes:
      - 'vo848kgko44wscs08kg8wwcg_twwsc88wo448cccs004os408-browser-data:/config'
    shm_size: 2g
    healthcheck:
      test:
        - CMD-SHELL
        - "bash -c ':> /dev/tcp/127.0.0.1/9222' || exit 1"
      interval: 5s
      timeout: 5s
      retries: 10
    container_name: browser-vo848kgko44wscs08kg8wwcg
    restart: unless-stopped
    labels:
      - coolify.managed=true
      - coolify.version=4.0.0-beta.463
      - coolify.serviceId=4
      - coolify.type=service
      - coolify.name=browser-twwsc88wo448cccs004os408
      - coolify.resourceName=openclaw
      - coolify.projectName=openclaw
      - coolify.serviceName=browser
      - coolify.environmentName=production
      - coolify.pullRequestId=0
      - coolify.service.subId=5
      - coolify.service.subType=application
      - coolify.service.subName=browser
      - coolify.managed=true
      - coolify.version=4.0.0-beta.463
      - coolify.serviceId=14
      - coolify.type=service
      - coolify.name=browser-vo848kgko44wscs08kg8wwcg
      - coolify.resourceName=service-t0w8wkcgk0g4k4kswkk8kks8
      - coolify.projectName=openclaw
      - coolify.serviceName=browser
      - coolify.environmentName=production
      - coolify.pullRequestId=0
      - coolify.service.subId=21
      - coolify.service.subType=application
      - coolify.service.subName=browser
    networks:
      vo848kgko44wscs08kg8wwcg: null
    env_file:
      - .env
volumes:
  twwsc88wo448cccs004os408_openclaw-data:
    name: twwsc88wo448cccs004os408_openclaw-data
  twwsc88wo448cccs004os408_browser-data:
    name: twwsc88wo448cccs004os408_browser-data
  vo848kgko44wscs08kg8wwcg_twwsc88wo448cccs004os408-openclaw-data:
    name: vo848kgko44wscs08kg8wwcg_twwsc88wo448cccs004os408-openclaw-data
  vo848kgko44wscs08kg8wwcg_twwsc88wo448cccs004os408-browser-data:
    name: vo848kgko44wscs08kg8wwcg_twwsc88wo448cccs004os408-browser-data
networks:
  twwsc88wo448cccs004os408:
    name: twwsc88wo448cccs004os408
    external: true
  vo848kgko44wscs08kg8wwcg:
    name: vo848kgko44wscs08kg8wwcg
    external: true

